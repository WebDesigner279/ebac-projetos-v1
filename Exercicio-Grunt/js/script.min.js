let editIndex=null;function calculateExceededTime(e,t,n){t=new Date(t+"T"+e),e=new Date,t=new Date(t.getTime()+6e4*n);return t<e?Math.floor((e-t)/6e4):0}function updateExceededTimes(){var e=document.querySelectorAll("#vehicleTable tr");let n=JSON.parse(localStorage.getItem("vehicles"))||[];e.forEach((e,t)=>{t<n.length&&(t=calculateExceededTime((t=n[t]).entryTime,t.entryDate,t.parkingDuration),(e=e.cells[10]).innerText=0<t?t+" min":"No prazo",e.className=0<t?"text-danger":"text-success")})}function updateVehicleTable(){var e=JSON.parse(localStorage.getItem("vehicles"))||[];let a=document.getElementById("vehicleTable");a.innerHTML="",e.forEach((e,t)=>{var n=a.insertRow(),e=(n.insertCell(0).innerText=e.vehicleType,n.insertCell(1).innerText=e.plate,n.insertCell(2).innerText=e.color,n.insertCell(3).innerText=e.owner,n.insertCell(4).innerText=e.apartment,n.insertCell(5).innerText=e.block,n.insertCell(6).innerText=e.parkingSpot,n.insertCell(7).innerText=e.entryTime,n.insertCell(8).innerText=e.entryDate,n.insertCell(9).innerText=e.parkingDuration+" min",calculateExceededTime(e.entryTime,e.entryDate,e.parkingDuration)),l=n.insertCell(10),l=(l.innerText=0<e?e+" min":"No prazo",l.className=0<e?"text-danger":"text-success",n.insertCell(11)),e=(l.className="actions-cell",document.createElement("button")),n=(e.className="btn btn-warning btn-sm",e.innerText="Editar",e.onclick=function(){loadVehicleData(t)},l.appendChild(e),document.createElement("button"));n.className="btn btn-danger btn-sm",n.innerText="Excluir",n.onclick=function(){deleteVehicle(t)},l.appendChild(n)})}function loadVehicleData(e){var t=(JSON.parse(localStorage.getItem("vehicles"))||[])[e];document.getElementById("vehicleType").value=t.vehicleType,document.getElementById("plate").value=t.plate,document.getElementById("color").value=t.color,document.getElementById("owner").value=t.owner,document.getElementById("apartment").value=t.apartment,document.getElementById("block").value=t.block,document.getElementById("parkingSpot").value=t.parkingSpot,document.getElementById("entryTime").value=t.entryTime,document.getElementById("entryDate").value=t.entryDate,document.getElementById("parkingDuration").value=t.parkingDuration,editIndex=e}function deleteVehicle(e){var t=JSON.parse(localStorage.getItem("vehicles"))||[];t.splice(e,1),localStorage.setItem("vehicles",JSON.stringify(t)),updateVehicleTable()}function filterVehicles(){let a=document.getElementById("searchInput").value.toLowerCase();document.querySelectorAll("#vehicleTable tr").forEach(e=>{var[t,n,,l]=e.cells,t=(`${t.textContent} ${n.textContent} `+l.textContent).toLowerCase();e.style.display=t.includes(a)?"":"none"})}document.getElementById("vehicleForm").addEventListener("submit",function(e){e.preventDefault();var e={vehicleType:document.getElementById("vehicleType").value,plate:document.getElementById("plate").value,color:document.getElementById("color").value,owner:document.getElementById("owner").value,apartment:document.getElementById("apartment").value,block:document.getElementById("block").value,parkingSpot:document.getElementById("parkingSpot").value,entryTime:document.getElementById("entryTime").value,entryDate:document.getElementById("entryDate").value,parkingDuration:parseInt(document.getElementById("parkingDuration").value)},t=JSON.parse(localStorage.getItem("vehicles"))||[];null!==editIndex?(t[editIndex]=e,editIndex=null):t.push(e),localStorage.setItem("vehicles",JSON.stringify(t)),updateVehicleTable(),document.getElementById("vehicleForm").reset()}),document.getElementById("btnCancelar").addEventListener("click",function(){document.getElementById("vehicleForm").reset(),editIndex=null}),document.getElementById("searchInput").addEventListener("input",filterVehicles),updateVehicleTable(),setInterval(updateExceededTimes,6e4);